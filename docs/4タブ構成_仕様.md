# 4タブ構成と承認フェーズの仕様

提案スプレッドシートは **4つのタブ** で構成し、**前提条件の承認フェーズ** を組み込む。  
出力は **1回の実行でスプレッドシートにドカンと入る** 形（Google Sheets 一括書き込み）を目指す。

---

## 1. タブ一覧

| タブ名 | 内容 |
|--------|------|
| **考えられる施策** | 共通パラメータ ＋ 施策ごとの項目・値・単位・メモ（既存の提案シート） |
| **費用対効果など** | 各施策の効果タイプ・月次/年次効果・回収期間・年次ROI・主要ドライバー・測定KPI・メモ。合計行あり。前提条件の承認後に確定する想定。 |
| **パッケージ** | 考えられる施策を組み合わせたパッケージ案（A/B/C等）。内容・想定メリット・システム数・初期費用・月次効果・回収期間・メモ。 |
| **ロードマップ** | 本番までの工程（例: 8週間 PoC→パイロット→本番）。工程・内容・W1〜W8 のタイムライン。 |
| **前提条件・承認** | 考えられる施策・費用対効果の前提条件一覧と、承認ステータス（未確認/確認済み）。承認フェーズ用。 |

---

## 2. 各タブの列定義

### タブ1: 考えられる施策（既存）

- 共通: 項目, 値, 単位, メモ
- 施策: 施策名 ＋ 項目, 値, 単位, メモ（繰り返し）

### タブ2: 費用対効果など（施策ごとの効果・回収・ROI）

| 列名 | 説明 |
|------|------|
| 施策 | 施策1: AI一次受付 ... など |
| 効果タイプ | 取りこぼし削減(粗利増) / 工数削減(人件費減) / 成約率改善(粗利増) など |
| 月次効果(円) | 月あたりの効果金額 |
| 年次効果(円) | 年あたりの効果金額 |
| 回収期間(日) | 初期費用を回収するまでの日数 |
| 年次ROI(1年目) | 1年目のROI（%） |
| 主要ドライバー(Inputs参照) | 効果を決める主な式・変数 |
| 測定KPI | 未対応率、成約率、CPA など |
| メモ | 補足 |

- 最終行: **合計(参考)** で月次効果・年次効果・回収期間・年次ROI を集計

### タブ3: パッケージ

| 列名 | 説明 |
|------|------|
| パッケージ | A: Sales Boost / B: Ops Efficiency / C: Full Stack など |
| 内容(導入システム) | 施策4+施策6 など |
| 想定メリット | 成約率/粗利の底上げ など |
| システム数 | 2, 3, 6 など |
| 初期費用(円) | 1000000 など |
| 月次効果(円) | 267000 など |
| 回収期間(月) | 3.7 など |
| メモ | 営業代行が主力なら最適 など |

### タブ4: ロードマップ（8週間: PoC→パイロット→本番）

| 列名 | 説明 |
|------|------|
| 工程 | 0. Kickoff / 1. データ・運用設計 / 2. 実装 / 3. PoC / 4. パイロット / 5. 本番展開 / 6. KPIレビュー |
| 内容 | 目的・KPI合意、現状フロー確認… など |
| W1 〜 W8 | 該当週にアクティブなら 1 や ●、そうでなければ空欄 |

### タブ5: 前提条件・承認

| 列名 | 説明 |
|------|------|
| 前提条件 | 例: 月の問い合わせ数 300件、CS/事務時給 1800円 |
| 区分 | 考えられる施策用 / 費用対効果用 |
| 承認ステータス | 未確認 / 確認済み |
| メモ | クライアント確認事項など |

- **考えられる施策** の値は、この「前提条件」が合意されたうえで使う想定。使えない施策は承認前に外す。
- **費用対効果** の数字は、前提条件が承認されたうえで確定する。

---

## 3. 承認フェーズの位置づけ

1. **考えられる施策** を生成 → クライアントと「この施策は使える/使わない」「この前提（数値）でいいか」を **確認・承認**。  
   → 前提条件・承認タブに「未確認」で一覧出し、確認済みになったら「確認済み」に更新。

2. **費用対効果** は、前提条件が承認されたら確定。承認前に「この条件で試算した結果」として出し、承認後に正式版として扱う。

3. **パッケージ**・**ロードマップ** は、考えられる施策・費用対効果の前提が固まったあとで参照しやすい。

---

## 4. 出力形式（ドカンと入れる）

- **Google Sheets API** で、1つのスプレッドシートを新規作成し、上記 **5タブ**（考えられる施策 / 費用対効果など / パッケージ / ロードマップ / 前提条件・承認）をシートとして作成。
- 1回の実行で、**全シートにデータを書き込む**。CSVを4本貼り直す必要はない。
- 認証はサービスアカウント（JSONキー）を想定。環境変数でキーファイルパスを指定。

---

## 5. 実行方法

```bash
npm run full:example
# または
npx tsx scripts/run-full-sheets.ts --input inputs/example_company.json
```

- **GOOGLE_APPLICATION_CREDENTIALS** にサービスアカウントJSONのパスを設定している場合: 新規スプレッドシートが作成され、5シートにドカンとデータが入る。URLが標準出力に出る。
- **未設定の場合**: `data/out/` に 5つの CSV（考えられる施策、費用対効果など、パッケージ、ロードマップ、前提条件・承認）が出力される。手動でスプレッドシートにインポート可能。
