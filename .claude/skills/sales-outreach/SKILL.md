---
name: sales-outreach
description: gen-reportの出力を元に、個別営業メッセージ（HP型テンプレート）を生成する
allowed-tools: AskUserQuestion, Bash, Read, Write
---

# 営業アプローチメッセージ生成

gen-reportで生成済みのレポートデータを元に、個別感のある初回フォームメール（Template 2: HP型）を生成します。

## ステップ1: 入力の確認

引数 `$ARGUMENTS` から会社名またはinputファイルパスを読み取ります。

このリポジトリのルートディレクトリ（`package.json` があるディレクトリ）の
`data/out/` フォルダから、該当する `*_outreach-data.json` ファイルを探します。

```bash
ls data/out/*outreach-data.json
```

該当ファイルが見つからない場合は、ユーザーに以下を案内してください：
「先にgen-reportスキルでレポートを生成してください。」

## ステップ2: データの読み込み

Read ツールで `data/out/{company}_outreach-data.json` を読み込みます。

JSONには以下の情報が含まれます：
- `companyName`: 会社名
- `industry`: 業種
- `businessSummary`: 事業概要（HPから抽出）
- `keywords`: キーワード一覧
- `focusAreas`: 注力部門
- `siteUrl`: ホームページURL
- `reportUrl`: 生成済みレポートURL
- `initiatives[]`: AI施策一覧（施策名・月次効果額・年次効果額・効果種別・KPI）
- `topPackage`: 最もROIの高いパッケージ情報

また、リポジトリルートの `.env` ファイルから署名情報を読み取ります：
- `SENDER_COMPANY`: 自社名
- `SENDER_NAME`: 担当者名
- `SENDER_EMAIL`: メールアドレス
- `SENDER_PHONE`: 電話番号

## ステップ3: メッセージ生成

読み込んだデータを使って、以下のルールに従いメールの件名と本文を生成してください。

### 生成ルール（鉄則5か条）

1. **「情報を届けに来た人」スタンス** — 売り込みは一切しない。導入・契約・料金という単語を使わない
2. **HPで実際に見た内容を1つ具体的に言及** — `businessSummary` と `keywords` から、相手のHPを見たことが伝わる文を作る
3. **具体的な数字を1つ使う** — `initiatives[]` の中で最も `monthlyEffectYen` が大きい施策の効果額を使う（例: 「月40時間の削減」「月次○万円の効果」）
4. **「断る許可」フレーズを必ず入れる** — 「もちろん、今はそのタイミングでなければ全く問題ありません」等
5. **1通1テーマ** — 最も効果の高い施策1つだけに絞る

### メール構造（Template 2: HP型）

```
件名：{会社名}様、{HPで見た具体的な活動や特徴}の部分でAIが役立てるかもしれません

{会社名}
ご担当者様

突然のご連絡失礼いたします。{自社名}の{担当者名}と申します。

御社のホームページを拝見しました。
{businessSummaryから具体的に1つ言及：例「多くの現場を運営されていることがわかりました」}

その規模で業務を回されているということは、
{keywordsやfocusAreasから推測される課題を1文で}とふと気になりご連絡しました。

実は、似たような状況の会社さんで
{initiatives[]の最優先施策の効果を具体的に1文で：例「○○業務をAIに任せることで、月○万円分の工数を削減した」}
という事例があります。

御社に当てはまるかどうかはわかりませんが、
もし少しでも「うちも同じかも」と感じたなら、
一度だけ詳しくお話しできれば嬉しいです。

ご都合がよければ30分ほど、オンラインでもご対面でも。
もちろん、今はそのタイミングでなければ全く問題ありません。

{担当者名}｜{自社名}
{メールアドレス} ｜ {電話番号}
```

### フォールバック

`businessSummary` が極端に短い（50文字未満）または「その他」のみの場合は、
Template 1（基本型）にフォールバックしてください。
基本型では、HPへの具体的な言及の代わりに「御社のような{industry}の{規模感}の会社さんでは〜」という一般的な導入にします。

## ステップ4: 出力

生成したメールをコードブロックで囲んでユーザーに提示します。
件名と本文を分けて表示し、コピーしてすぐ使える形にしてください。

## ステップ5: CRM更新（任意）

AskUserQuestion ツールで以下を確認します：
「生成したメッセージをCRMに書き込み、ステータスを『アプローチ済み』に更新しますか？」

「はい」の場合、生成したメッセージ本文（件名は含めず本文のみ）を変数に保持し、
リポジトリのルートで以下を実行します：

```bash
npx tsx scripts/update-crm-status.ts --company-name "{会社名}" --outreach-message "{生成した本文}"
```

注意: `--outreach-message` の値にはシェルエスケープが必要です。
改行は `\n` に置換し、シングルクォートで囲んでください。
メッセージが長い場合は、一時ファイルに書き出して `cat` で渡す方法も可です：

```bash
# 一時ファイル経由の例
cat > /tmp/outreach-msg.txt << 'OUTREACH_EOF'
（生成した本文）
OUTREACH_EOF
npx tsx scripts/update-crm-status.ts --company-name "{会社名}" --outreach-message "$(cat /tmp/outreach-msg.txt)"
```

「いいえ」の場合はスキップします。
