---
name: lead-scoring
description: CRMのリードに対してスコアリング（A/B/Cランク判定）を実行し、推奨アクションを生成する
allowed-tools: AskUserQuestion, Bash, Read, Write
---

# リードスコアリング

CRMに登録済みのリード企業に対して、企業属性・接触結果・レポートデータを元にスコアリングを実施し、
A/B/Cランク判定と推奨アクションを生成します。

## ステップ1: 対象リードの特定

引数 `$ARGUMENTS` から対象を判定します。

- 会社名が指定された場合: その会社を対象にする
- `--all` が指定された場合: CRM内のスコア未記入の全リードを対象にする
- 何も指定されていない場合: AskUserQuestion で会社名を確認する

## ステップ2: CRMデータの読み取り

リポジトリのルートディレクトリで以下を実行し、CRMから対象のデータを取得します：

```bash
npx tsx scripts/read-crm-lead.ts --company-name "{会社名}"
```

または一括の場合:
```bash
npx tsx scripts/read-crm-lead.ts --unscored
```

出力されるJSONフィールド:
- `rowIndex`: CRM上の行番号
- `companyName`, `siteUrl`, `address`, `phone`: 基本情報
- `reportUrl`: レポートURL
- `outreachMessage`: フォーム営業文
- `status`: 現在のステータス
- `score`, `rank`: 現在のスコア/ランク（あれば）
- `pipeline`: パイプラインステージ
- `dealAmount`, `winProbability`, `expectedCloseDate`: ディール情報
- `contactName`, `contactEmail`, `contactDepartment`: 担当者情報
- `lastContactDate`: 最終接触日

## ステップ3: レポートデータの読み込み

リポジトリの `data/out/` フォルダから `*_outreach-data.json` を探し、該当企業のデータがあれば Read ツールで読み込みます。

```bash
ls data/out/*outreach-data.json
```

レポートデータがある場合、以下をスコアリングに活用:
- `initiatives[]`: AI施策一覧（施策数・効果額）
- `industry`: 業種
- `businessSummary`: 事業概要

## ステップ4: 接触情報の収集

AskUserQuestion で以下を確認します:

**質問1: 接触経路**
- フォーム / テレアポ / 訪問 / メール返信 / まだ接触していない

**質問2: 反応温度**（接触済みの場合）
- 前のめり（積極的に質問・メモを取る）
- 普通（話は聞くが質問なし）
- 薄い（明らかに興味なし）
- 未接触

**質問3: 企業規模**
- 5名以下 / 6〜20名 / 21〜50名 / 51名以上 / 不明

**質問4: 接触メモ**（任意・フリーテキスト）
経路に応じた詳細を記入してもらう。以下のシグナルを意識して聞き取る:
- テレアポの場合: 通話時間、具体的な業務名、社内共有の言及、折返しOK、予算・時期の言及、競合名
- フォームの場合: 具体的な記載内容、電話希望の有無、企業名実名記載、予算・規模の言及
- メール返信の場合: 返信内容の温度感、具体的課題、部署名・役職の有無
- 共通: 困りごとを具体的に聞けたか（業務名・時間まで把握）、メールアドレスを取得できたか

## ステップ5: スコア算出

以下のルールに従ってスコアを算出します。

### A. 基本スコア（全経路共通）

| 評価項目 | 詳細 | 点数 |
|---|---|---|
| 反応温度: 前のめり | 積極的に質問・メモを取る | +20 |
| 反応温度: 普通 | 話は聞くが質問なし | +10 |
| 反応温度: 薄い | 明らかに興味なし | +3 |
| 反応温度: 未接触 | | +0 |
| メールアドレス取得 | 連絡可能な状態になった（CRMのcontactEmail列が非空） | +10 |
| 企業規模 6〜20名 | AI化メリット大 | +8 |
| 企業規模 21〜50名 | 予算あり | +10 |
| 困りごとを具体的に聞けた | 業務名・時間まで把握 | +8 |

### B. 接触経路別スコア

#### 電話（テレアポ）追加スコア

| シグナル | 加算点 |
|---|---|
| 通話5分以上 | +13 |
| 具体的な業務名を話した（「見積もり」「日報」など） | +10 |
| 社内の誰かに話すと言った | +10 |
| 折り返し・資料送付OK | +8 |
| 予算・時期に言及 | +15 |
| 競合他社の名前が出た | +5 |

#### フォーム追加スコア

| シグナル | 加算点 |
|---|---|
| 具体的な記載あり（「〇〇業務を自動化したい」など） | +20 |
| 電話希望にチェック | +15 |
| 資料DL後に送信（検討成熟度が高い） | +18 |
| 企業名・実名記載 | +10 |
| 予算・規模に言及 | +10 |

#### メール返信追加スコア

| シグナル | 加算点 |
|---|---|
| 「詳しく聞きたい」「一度会えますか」 | +25〜30 |
| 具体的な課題を書いてきた | +20 |
| 「資料が欲しい」 | +15 |
| 「タイミングが来たら」（保留だが拒絶ではない） | +8 |
| 部署名・役職が署名にある | +5 |

### C. AI判定（レポートデータがある場合のみ）

レポートデータ（initiatives, industry, businessSummary）と接触メモを総合的に判断し、
以下の3軸で加点します（各0〜10点、合計最大30点）:

- **デジタル成熟度**: HP情報やレポート施策からAI活用への準備度を推定
- **ROI適合度**: 施策のROIが高く、自社サービスとのフィットが良いか
- **緊急度シグナル**: 接触メモから緊急性のシグナルがあるか

AI判定を行う際は、上記3つの軸ごとに点数と理由を明記してください。

### D. ランク判定

| ランク | スコア範囲 | 即時アクション | フォローサイクル |
|---|---|---|---|
| **A** | 70点以上 | 24時間以内に個別返信・アポ打診電話 | 週1回個別追客 |
| **B** | 40〜69点 | ナーチャリング5ステップ自動配信 | 週1配信→温度上昇で再接触 |
| **C** | 39点以下 | 3〜6ヶ月後リストへ移動 | 3ヶ月に1回確認 |

## ステップ6: 結果の表示

スコアリング結果をわかりやすく表示します:

```
━━━━━━━━━━━━━━━━━━━━━━━━
スコアリング結果: {会社名}
━━━━━━━━━━━━━━━━━━━━━━━━
スコア: {合計点}点 → ランク: {A/B/C}

【基本スコア内訳】
- 反応温度（{温度}）: +{点}
- メールアドレス取得: +{点}
- 企業規模（{規模}）: +{点}
- 困りごと把握: +{点}

【接触経路別スコア（{経路}）】
- {該当するシグナル1}: +{点}
- {該当するシグナル2}: +{点}
...

【AI判定】
- デジタル成熟度: +{点}（{理由}）
- ROI適合度: +{点}（{理由}）
- 緊急度シグナル: +{点}（{理由}）

【推奨アクション】
{ランクに応じた具体的なアクション1〜2文}
━━━━━━━━━━━━━━━━━━━━━━━━
```

推奨アクションの生成ルール:
- Aランク: 「24時間以内に電話でアポ打診。話すポイント: {接触メモから抽出した具体的なポイント}」
- Bランク: 「ナーチャリングシーケンスへ登録。{業種}向けの事例を中心にフォロー」
- Cランク: 「3ヶ月後リストへ移動。{次回接触時のフック}」

## ステップ7: CRM更新

AskUserQuestion で「スコアリング結果をCRMに書き込みますか？」と確認します。

「はい」の場合、リポジトリのルートで以下を実行:

```bash
npx tsx scripts/update-crm-score.ts \
  --company-name "{会社名}" \
  --score {スコア} \
  --rank "{ランク}" \
  --contact-type "{接触経路}" \
  --memo "{反応メモ（シェルエスケープ注意）}" \
  --action "{推奨アクション}"
```

メモやアクションが長い場合は一時ファイル経由で渡してください。

ランクに応じてH列（ステータス）とO列（パイプライン）も自動更新されます:
- A → ステータス「Aランク対応中」/ パイプライン「商談」
- B → ステータス「ナーチャリング中」/ パイプライン「アプローチ中」
- C → ステータス「3ヶ月後フォロー」/ パイプライン「リード」

ステータスを変更したくない場合は `--no-status-update` を付与してください。

スコアリング実行時にアクティビティタブにも自動で記録されます。
